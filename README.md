# Claude Code Usage Tracker

ãƒãƒ¼ãƒ ã®Claude Codeåˆ©ç”¨çŠ¶æ³ã‚’åé›†ãƒ»å¯è¦–åŒ–ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã‚»ãƒƒãƒˆã§ã™ã€‚

## ğŸ“Š æ¦‚è¦

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Claude Code    â”‚     â”‚    Amazon S3    â”‚     â”‚    TROCCO       â”‚     â”‚   Snowflake +   â”‚
â”‚   ãƒ—ãƒ©ã‚°ã‚¤ãƒ³    â”‚â”€â”€â”€â”€â–¶â”‚   ãƒ­ã‚°ä¿å­˜      â”‚â”€â”€â”€â”€â–¶â”‚   ãƒ‡ãƒ¼ã‚¿é€£æº    â”‚â”€â”€â”€â”€â–¶â”‚   Streamlit     â”‚
â”‚  (ãƒ‡ãƒ¼ã‚¿åé›†)   â”‚     â”‚                 â”‚     â”‚                 â”‚     â”‚  ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
claude-usage-tracker/
â”œâ”€â”€ README.md                 # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ plugin/                   # Claude Code ãƒ—ãƒ©ã‚°ã‚¤ãƒ³
â”‚   â”œâ”€â”€ .claude-plugin/
â”‚   â”‚   â””â”€â”€ marketplace.json
â”‚   â””â”€â”€ usage-tracker/
â”‚       â”œâ”€â”€ .claude-plugin/
â”‚       â”‚   â””â”€â”€ plugin.json
â”‚       â”œâ”€â”€ commands/         # ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚³ãƒãƒ³ãƒ‰
â”‚       â”œâ”€â”€ hooks/            # ã‚¤ãƒ™ãƒ³ãƒˆåé›†Hook
â”‚       â””â”€â”€ scripts/          # ã‚¤ãƒ™ãƒ³ãƒˆé€ä¿¡ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ s3-upload/                # S3ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ„ãƒ¼ãƒ«
â”‚   â””â”€â”€ setup_and_upload.ps1
â”œâ”€â”€ snowflake/                # Snowflake + Streamlit
â”‚   â”œâ”€â”€ 01_create_tables.sql
â”‚   â”œâ”€â”€ 02_load_data.sql
â”‚   â””â”€â”€ 03_streamlit_app.py
â””â”€â”€ docs/                     # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
    â””â”€â”€ SETUP_GUIDE_FOR_TEAM.md
```

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### ç®¡ç†è€…å‘ã‘

1. **S3ãƒã‚±ãƒƒãƒˆã‚’ä½œæˆ**
   ```powershell
   aws s3api create-bucket --bucket claude-activity-log-YOUR_ACCOUNT_ID --region ap-northeast-1 --create-bucket-configuration LocationConstraint=ap-northeast-1
   ```

2. **Snowflakeãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ**
   - `snowflake/01_create_tables.sql` ã‚’å®Ÿè¡Œ

3. **TROCCOã§ãƒ‡ãƒ¼ã‚¿é€£æºã‚’è¨­å®š**
   - S3 â†’ Snowflake ã®è»¢é€ã‚¸ãƒ§ãƒ–ã‚’ä½œæˆ

4. **Streamlitãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤**
   - `snowflake/03_streamlit_app.py` ã‚’Streamlit in Snowflakeã«ãƒ‡ãƒ—ãƒ­ã‚¤

### ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼å‘ã‘

[ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰](docs/SETUP_GUIDE_FOR_TEAM.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## ğŸ“¦ é…å¸ƒç‰©

ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã«é…å¸ƒã™ã‚‹ã‚‚ã®:

| ãƒ•ã‚¡ã‚¤ãƒ« | èª¬æ˜ |
|---------|------|
| `plugin/` ãƒ•ã‚©ãƒ«ãƒ€ | Claude Code ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ |
| `s3-upload/setup_and_upload.ps1` | S3ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ |
| `docs/SETUP_GUIDE_FOR_TEAM.md` | ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †æ›¸ |

### ZIPãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

```powershell
# ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ZIP
Compress-Archive -Path plugin\* -DestinationPath usage-tracker-plugin.zip

# S3ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ„ãƒ¼ãƒ«ã®ZIP
Compress-Archive -Path s3-upload\* -DestinationPath s3-upload-tools.zip
```

## ğŸ“Š åé›†ã™ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹

| ãƒ¡ãƒˆãƒªã‚¯ã‚¹ | èª¬æ˜ |
|-----------|------|
| ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•° | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆé€ä¿¡å›æ•° |
| ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œæ•° | Read, Write, Bash, Editç­‰ã®åˆ©ç”¨å›æ•° |
| MCPå‘¼ã³å‡ºã— | MCPãƒ„ãƒ¼ãƒ«ã®å‘¼ã³å‡ºã—å›æ•° |
| Subagentæ•° | ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®åˆ©ç”¨å›æ•° |
| ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•° | ä½œæ¥­ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æ•° |

## ğŸ”’ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼

ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’**é€ä¿¡ã—ã¾ã›ã‚“**:

- âŒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®å†…å®¹
- âŒ ã‚³ãƒ¼ãƒ‰ã®å†…å®¹
- âŒ ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹
- âŒ ãƒ„ãƒ¼ãƒ«å‡ºåŠ›ã®è©³ç´°

é€ä¿¡ã™ã‚‹ã®ã¯ä»¥ä¸‹ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®ã¿ã§ã™:

- âœ… ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ï¼ˆSessionStart, PostToolUseç­‰ï¼‰
- âœ… ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
- âœ… ãƒ„ãƒ¼ãƒ«åï¼ˆRead, Write, Bashç­‰ï¼‰
- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
- âœ… ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ/å‡ºåŠ›ã®**é•·ã•**ã®ã¿

## ğŸ“ S3ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆ

```
s3://claude-activity-log-XXXXXXXXXXXX/
â””â”€â”€ claude-usage-logs/
    â””â”€â”€ {IAMãƒ¦ãƒ¼ã‚¶ãƒ¼å}/
        â””â”€â”€ {yyyy}/
            â””â”€â”€ {MM}/
                â””â”€â”€ {dd}/
                    â””â”€â”€ events-yyyy-MM-dd.jsonl
```

## ğŸ› ï¸ é–‹ç™ºãƒ»ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä¿®æ­£

1. `plugin/usage-tracker/` å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†
2. ãƒ†ã‚¹ãƒˆ:
   ```
   /plugin uninstall usage-tracker@usage-tracker-marketplace
   /plugin install usage-tracker@usage-tracker-marketplace
   ```

### ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ä¿®æ­£

1. `snowflake/03_streamlit_app.py` ã‚’ç·¨é›†
2. Streamlit in Snowflakeã§å†ãƒ‡ãƒ—ãƒ­ã‚¤

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€Issueã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
